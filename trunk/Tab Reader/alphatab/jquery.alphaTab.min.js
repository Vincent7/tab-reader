var alphaTabWrapper;(function(a){alphaTabWrapper=function(b,l){var k=this;var b=a(b);this.el=b;this.factory=new alphatab.tablature.model.SongFactoryImpl();var i="alphaTab.flashloader.swf";var c=a("script[src$=/alphaTab.js]");if(c.length==0){c=a("script[src$=/alphaTab.min.js]")}var g="";if(c.length){var e=function(q){var m=location,o,t,r,n;if(/^\w+:/.test(q)){return q}o=m.protocol+"//"+m.host;if(q.indexOf("/")==0){return o+q}t=m.pathname.replace(/\/[^\/]*$/,"");r=q.match(/\.\.\//g);if(r){q=q.substring(r.length*3);for(n=r.length;n--;){t=t.substring(0,t.lastIndexOf("/"))}}return o+t+"/"+q};g=e(c.attr("src"));g=g.substr(0,g.lastIndexOf("/"))}var f={base:g,file:null,track:0,loadCallback:null,errorCallback:null,error:"Load a file to display the tablature",zoom:1.1,width:600,height:200,autoSize:true};this.options=a.extend(f,l);this.loadAlphaTex=function(n){try{k.tablature.isError=false;var p=new alphatab.file.alphatex.AlphaTexParser();var m=new alphatab.platform.BinaryReader();m.initialize(n);p.init(m,k.factory);j(p.readSong())}catch(o){h(o)}};this.loadFile=function(m){try{alphatab.file.SongLoader.loadSong(m,k.factory,j)}catch(n){h(n)}};this.loadCallbacks=[];var j=function(n){if(k.options.loadCallback){k.options.loadCallback(n)}k.tablature.setTrack(n.tracks[k.options.track]);for(var m=0;m<k.loadCallbacks.length;m++){k.loadCallbacks[m](n)}};var h=function(m){if(m instanceof alphatab.file.FileFormatException){m=m.message}if(k.options.errorCallback){k.options.errorCallback(m)}else{k.tablature.isError=true;k.tablature.updateDisplay=true;k.tablature.errorMessage=m;k.tablature.invalidate()}};this.contents=a.trim(b.text());b.html("");document.createElement("canvas");this.canvas=a('<canvas id="tab0" width="'+(window.innerWidth)+'" height="'+this.options.height+'" class="alphaTabSurface"></canvas>');b.append(this.canvas);this.canvas=this.canvas[0];if(a.browser.msie){if(a.browser.version<9){var d=function(o){var q=o.outerHTML;var p=o.ownerDocument.createElement(q);if(q.slice(-2)!="/>"){var m="/"+o.tagName;var n;while((n=o.nextSibling)&&n.tagName!=m){n.removeNode()}if(n){n.removeNode()}}o.parentNode.replaceChild(p,o);return p};this.canvas=G_vmlCanvasManager.initElement(d(this.canvas))}}this.tablature=new alphatab.tablature.Tablature(this.canvas,this.options.error);this.tablature.autoSizeWidth=this.options.autoSize;this.tablature.updateScale((navigator.userAgent.match("iPhone")!=null)?0.66:1);if(this.options.file){this.loadFile(this.options.file)}else{if(this.contents!=""){this.loadAlphaTex(this.contents)}}};alphaTabWrapper.fn=alphaTabWrapper.prototype;a.fn.alphaTab=function(c){var b=[];for(var d=0;d<this.length;d++){if(!this[d].alphaTab){this[d].alphaTab=new alphaTabWrapper(this[d],c)}b.push(this[d].alphaTab)}return b.length>1?b:b[0]}})(jQuery);document.write('<script type="text/vbscript">\nFunction VbAjaxLoader(method, fileName)\n	Dim xhr\n	Set xhr = CreateObject("Microsoft.XMLHTTP")\n\n	xhr.Open method, fileName, False\n\n	xhr.setRequestHeader "Accept-Charset", "x-user-defined"\n	xhr.send\n\n	Dim byteArray()\n\n	if xhr.Status = 200 Then\n		Dim byteString\n		Dim i\n\n		byteString=xhr.responseBody\n\n		ReDim byteArray(LenB(byteString))\n\n		For i = 1 To LenB(byteString)\n			byteArray(i-1) = AscB(MidB(byteString, i, 1))\n		Next\n	End If\n\n	VbAjaxLoader=byteArray\nEnd Function\n<\/script>');